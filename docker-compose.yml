services:
  crafty:
    image: registry.gitlab.com/crafty-controller/crafty-4:latest
    container_name: crafty
    restart: unless-stopped
    environment:
      TZ: ${TZ}
    ports:
      - "8000:8000"
      - "8443:8443"
      - "25565:25565" # Velocity Proxy
    volumes:
      - crafty_config:/crafty/app/config
      - crafty_backups:/crafty/app/backups
      - crafty_servers:/crafty/app/servers
      - crafty_logs:/crafty/app/logs
      - crafty_import:/crafty/app/import

  teamspeak:
    image: teamspeak:latest
    container_name: teamspeak
    restart: unless-stopped
    environment:
      TS3SERVER_LICENSE: accept
    ports:
      - "9987:9987/udp"
      - "10011:10011"
      - "30033:30033"
    volumes:
      - teamspeak_data:/var/ts3server

  caddy:
    image: caddy:2-alpine
    container_name: caddy
    restart: unless-stopped
    environment:
      CRAFTY_DOMAIN: ${CRAFTY_DOMAIN}
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile:ro
      - caddy_data:/data
      - caddy_config:/config

volumes:
  crafty_config:
  crafty_backups:
  crafty_servers:
  crafty_logs:
  crafty_import:
  teamspeak_data:
  caddy_data:
  caddy_config:
